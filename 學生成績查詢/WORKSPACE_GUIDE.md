# Google Workspace 專用完整部署手冊 (學校/企業版)

本手冊專為 **使用學校信箱 (.edu.tw) 或企業信箱** 的使用者設計。
請**忽略**原本的 `DEPLOY_GUIDE.md`，直接依照本手冊操作，以避免混淆。

---

## 核心差異說明

在 Google Workspace (組織帳號) 環境中，您的權限受學校/組織的資安政策控管，因此：
1. **預設可能無法對外公開**（找不到「任何人」選項）。
2. **學生可能必須登入**才能查詢。

請依學生是否有學校帳號，選擇以下一種方案：

---

## 方案 A：校內限定模式 (✅ 最推薦、最簡單)

**適用情境**：全校學生都有 Google 帳號 (同網域)，且老師不想麻煩資訊組長開權限。
**特點**：無需管理員設定，安全性最高，但**學生必須登入學校帳號**。

### 步驟 1：準備程式碼
*(若您已貼上程式碼，請跳至步驟 2)*

1. 開啟 Google Sheet，點選「擴充功能」>「Apps Script」。
2. 將 `Code.js` 內容貼入 `程式碼.gs`。
3. 新增 `Index.html` 並貼入內容。
4. 修改 `Code.js` 第 19 行 `ADMIN_EMAIL` 為您的信箱。
5. 儲存檔案。

### 步驟 2：部署為網頁應用程式 (關鍵步驟)

1. 點選右上角 **「部署」** > **「新增部署作業」**。
2. 左側齒輪選擇 **「網頁應用程式」**。
3. 設定如下：
   - **說明**：`校內查詢 V1`
   - **執行身分**：`我 (您的 Email)`  <-- 重要！
   - **存取權使用者**：`僅限 [您的學校機構] 的使用者`
     *(例如：僅限 National Taiwan University 的使用者)*

4. 點選 **「部署」**。
5. 複製產生的網址。

### 步驟 3：學生如何使用

1. 請告知學生：「查詢成績時，請務必先登入學校 Google 帳號」。
2. 若學生用私人 Gmail 開啟，會看到「需要權限」的畫面，請他們切換帳號即可。

---

## 方案 B：完全公開模式 (需管理員權限)

**適用情境**：學生沒有學校帳號，或您希望家長也能直接查詢 (不需登入)。
**困難點**：預設通常是關閉的，**必須**請學校資訊組長/管理員協助開啟。

### 第一階段：管理員設定 (請將此段傳給資訊組長)

若您是管理員，請依下列步驟開啟權限：

1. 登入 **[Google Admin Console (管理控制台)](https://admin.google.com)**。
2. 導航至：**應用程式 (Apps)** > **Google Workspace** > **雲端硬碟與文件 (Drive and Docs)**。
3. 點選 **「共用設定 (Sharing settings)」**。
4. 在「共用選項」中，將設定改為：
   - ✅ **開啟 (On)** - 允許使用者與網域外的人共用檔案。
   - ✅ **勾選「允許使用者發布網頁 (Allow users to publish files on the web)」**。
   *(這是 Apps Script 能否選「任何人」的關鍵)*
5. 點選儲存。(設定生效可能需等待 1-24 小時)

### 第二階段：老師部署

確認權限已開啟後 (或重新整理網頁)：

1. 回到部署畫面 (**「部署」** > **「新增部署作業」**)。
2. 設定如下：
   - **執行身分**：`我 (您的 Email)`
   - **存取權使用者**：`任何人 (Anyone)`
     *(如果還是沒看到這個選項，代表管理員設定尚未生效，或您位於「共用雲端硬碟」中)*
3. 部署後，任何人皆可直接開啟網址查詢，無需登入。

---

## ⚠️ 常見問題與障礙排除

### Q1: 我明明選了方案 A，為什麼學生還是進不去？
**原因**：學生手機可能預設登入的是私人 Gmail。
**解法**：請學生使用瀏覽器的 **「無痕視窗 / 私密瀏覽」**，然後在登入畫面輸入學校帳號。

### Q2: 「存取權使用者」選單裡完全沒有「任何人」？
**原因**：這代表學校政策強制關閉了對外分享，且管理員尚未依「方案 B」開啟權限。
**解法**：請暫時使用「方案 A」，或聯繫資訊組長。

### Q3: 使用「共用雲端硬碟 (Shared Drive)」的限制
若您的 Google Sheet 放在「共用運端硬碟」內，該硬碟可能有獨立的分享設定，會覆蓋全域設定。
**解法**：建議將 Google Sheet 移至 **「我的雲端硬碟 (My Drive)」** 根目錄下，再進行部署，通常權限問題較少。

---

**總結建議**：
為了省去溝通成本與隱私考量，我們強烈建議優先採用 **方案 A (校內限定模式)**。
