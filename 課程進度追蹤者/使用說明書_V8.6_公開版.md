# æ•™å­¸é€²åº¦è¿½è¹¤è€… V8.6 (å…¬é–‹ç‰ˆ) ä½¿ç”¨èªªæ˜æ›¸

æ­¡è¿ä½¿ç”¨ **æ•™å­¸é€²åº¦è¿½è¹¤è€… V8.6**ï¼é€™æ˜¯ä¸€å€‹å°ˆç‚ºæ•™å¸«è¨­è¨ˆçš„è¼•é‡ç´šé€²åº¦ç®¡ç†å·¥å…·ï¼Œç„¡éœ€å®‰è£ã€ç„¡éœ€é€£ç¶²å³å¯åœ¨ç€è¦½å™¨ä¸­ä½¿ç”¨ï¼ˆé›²ç«¯åŠŸèƒ½é™¤å¤–ï¼‰ã€‚V8.6 ç‰ˆæœ¬å¸¶ä¾†äº†æ›´æµæš¢çš„ä»‹é¢ã€æ‹–æ›³æ’åºåŠŸèƒ½ä»¥åŠæ›´å®Œå–„çš„æ®µè€ƒå€’æ•¸ç³»çµ±ã€‚

---
## ğŸŒŸ é‡é»åŠŸèƒ½
1.  **ç­ç´šé€²åº¦ç®¡ç†**ï¼šè¼•é¬†è¨˜éŒ„æ¯ä¸€ç¯€èª²çš„é€²åº¦ã€ä½œæ¥­èˆ‡å°è€ƒã€‚
2.  **è¦–è¦ºåŒ–çµ±è¨ˆ**ï¼šé¦–é ç›´è§€é¡¯ç¤ºã€Œæ®µè€ƒå€’æ•¸ã€èˆ‡ã€Œé€²åº¦æ¢ã€ï¼ŒæŒæ¡æ•™å­¸ç¯€å¥ã€‚
3.  **åˆ†å­¸å¹´ç®¡ç†**ï¼šæ”¯æ´å¤šå­¸å¹´ï¼ˆå¦‚ 113-1, 114-1ï¼‰åˆ‡æ›ï¼Œè³‡æ–™ç¨ç«‹ä¸æ··äº‚ã€‚
4.  **æ‹–æ›³æ’åº (New!)**ï¼šé•·æŒ‰ç­ç´šå¡ç‰‡å·¦å´æ‰‹æŠŠï¼Œå³å¯è‡ªç”±èª¿æ•´ç­ç´šé †åºã€‚
5.  **Smart Input (New!)**ï¼šæ–°å¢é€²åº¦æ™‚ï¼Œè‡ªå‹•åµæ¸¬ä¸¦å»ºè­°ã€Œè‡ªå‹•å¸¶å…¥ã€å…¶ä»–ç­ç´šçš„æœ€æ–°é€²åº¦ã€‚
6.  **é›²ç«¯åŒæ­¥èˆ‡ LINE Bot**ï¼šé€£çµ Google Sheetï¼Œå¯¦ç¾æ‰‹æ©Ÿ LINE å‚³è¨Šæ¯è‡ªå‹•è¨˜å¸³ï¼ˆéœ€è¨­å®šï¼‰ã€‚

---
## ğŸš€ å¿«é€Ÿä¸Šæ‰‹

### 1. æ–°å¢ç­ç´š
1. é»æ“Šå³ä¸‹è§’çš„ **ã€Œè¨­å®š (é½’è¼ªåœ–ç¤º)ã€**ã€‚
2. åœ¨ **ã€Œæ’èª²ã€** åˆ†é ä¸­ï¼Œè¼¸å…¥ç­ç´šåç¨±ï¼ˆä¾‹å¦‚ï¼š101ç­ï¼‰ã€‚
3. **é‡è¦**ï¼šé»é¸è©²ç­ç´šæ¯é€±çš„ä¸Šèª²æ—¥ï¼ˆä¾‹å¦‚é€±ä¸€ã€é€±ä¸‰ï¼‰ï¼Œé€™æœƒå½±éŸ¿è¡Œäº‹æ›†é¡¯ç¤ºã€‚
4. æŒ‰ä¸‹ã€Œ+ã€æŒ‰éˆ•æ–°å¢ã€‚

### 2. è¨­å®šæ®µè€ƒæ—¥æœŸ
1. é€²å…¥ **ã€Œè¨­å®šã€** > **ã€Œæ®µè€ƒã€**ã€‚
2. é‡å°ç›®å‰çš„å­¸å¹´åº¦ï¼ˆä¾‹å¦‚ 114-1ï¼‰ï¼Œè¨­å®šç¬¬ä¸€æ¬¡ã€ç¬¬äºŒæ¬¡æ®µè€ƒåŠæœŸæœ«è€ƒçš„æ—¥æœŸç¯„åœã€‚
3. è¨­å®šå®Œæˆå¾Œï¼Œé¦–é çš„ç­ç´šå¡ç‰‡æœƒå‡ºç¾å€’æ•¸è¨ˆæ™‚å¾½ç« ï¼ˆä¾‹å¦‚ï¼šä¸€æ®µå‰ 5 å ‚ï¼‰ã€‚

### 3. æ–°å¢æ•™å­¸é€²åº¦
1. åœ¨é¦–é å·¦å´ï¼ˆé›»è…¦ç‰ˆï¼‰æˆ–é»æ“Šä¸‹æ–¹ã€Œ+ã€ï¼ˆæ‰‹æ©Ÿç‰ˆï¼‰å¡«å¯«è¡¨å–®ã€‚
2. é¸æ“‡ç­ç´šã€è¼¸å…¥ç§‘ç›®èˆ‡é€²åº¦ï¼ˆä¾‹å¦‚ï¼šç¬¬ä¸€ç« ï¼‰ã€‚
3. å¦‚æœæœ‰ä½œæ¥­æˆ–å°è€ƒï¼Œå¯ä¸€ä½µè¨˜éŒ„ã€‚
4. æŒ‰ä¸‹ **ã€Œå„²å­˜ã€**ã€‚

---
## â˜ï¸ é€²éšåŠŸèƒ½ï¼šé›²ç«¯åŒæ­¥èˆ‡ LINE Bot æ¶è¨­æ•™å­¸

æœ¬ç³»çµ±æ”¯æ´å°‡è³‡æ–™åŒæ­¥åˆ° Google Sheetï¼Œä¸¦é€é LINE æ©Ÿå™¨äººå‚³é€è¨Šæ¯ä¾†è¨˜éŒ„é€²åº¦ã€‚è«‹ä¾ç…§ä»¥ä¸‹æ­¥é©Ÿè‡ªè¡Œæ¶è¨­ï¼ˆå®Œå…¨å…è²»ï¼Œå…å¯«ç¨‹å¼ï¼‰ã€‚

### æº–å‚™å·¥ä½œ
*   ä¸€å€‹ Google å¸³è™Ÿ
*   ä¸€å€‹ LINE å¸³è™Ÿ

### ç¬¬ä¸€éšæ®µï¼šå–å¾— Google Sheet ID
1.  å»ºç«‹ä¸€å€‹æ–°çš„ **Google Sheet (è©¦ç®—è¡¨)**ï¼Œå‘½åç‚ºã€Œæˆ‘çš„æ•™å­¸é€²åº¦ã€ã€‚
2.  è§€å¯Ÿç€è¦½å™¨ä¸Šæ–¹çš„ç¶²å€ï¼Œå®ƒæœƒé•·å¾—åƒé€™æ¨£ï¼š
    `https://docs.google.com/spreadsheets/d/`**`1ABCDE_FgHiJkLmNoPqRsTuVwXyZ`**`/edit...`
3.  è¤‡è£½ä¸­é–“é‚£ä¸²äº‚ç¢¼ï¼ˆç²—é«”éƒ¨åˆ†ï¼‰ï¼Œé€™å°±æ˜¯ **Sheet ID**ã€‚

### ç¬¬äºŒéšæ®µï¼šå»ºç«‹ LINE æ©Ÿå™¨äºº
1.  å‰å¾€ [LINE Developers Console](https://developers.line.biz/) ä¸¦ç™»å…¥ã€‚
2.  å»ºç«‹ä¸€å€‹ **Provider**ï¼ˆåç¨±éš¨æ„ï¼‰ã€‚
3.  å»ºç«‹ä¸€å€‹ **Create a new Channel**ï¼Œé¡å‹é¸æ“‡ **"Messaging API"**ã€‚
4.  å¡«å¯«å¿…å¡«è³‡æ–™ï¼ˆApp name, Description ç­‰ï¼‰ã€‚
5.  å»ºç«‹å¾Œï¼Œé»é¸ **Messaging API** åˆ†é ã€‚
6.  æ»‘åˆ°æœ€ä¸‹æ–¹ **Channel access token**ï¼Œé»æ“Š **Issue** (ç™¼è¡Œ)ã€‚
7.  è¤‡è£½é€™ä¸²é•·é•·çš„ Tokenï¼Œé€™å°±æ˜¯ **LINE Token**ã€‚

### ç¬¬ä¸‰éšæ®µï¼šéƒ¨ç½²ç¨‹å¼ç¢¼ (Google Apps Script)
1.  å‰å¾€ [Google Apps Script](https://script.google.com/home)ã€‚
2.  é»æ“Šå·¦ä¸Šè§’ **ã€Œæ–°å°ˆæ¡ˆã€**ã€‚
3.  å°‡ç·¨è¼¯å™¨å…§çš„ç¨‹å¼ç¢¼ **å…¨éƒ¨æ¸…ç©º**ï¼Œè²¼ä¸Šæœ¬æ–‡é™„éŒ„çš„ç¨‹å¼ç¢¼ã€‚
4.  ä¿®æ”¹ç¨‹å¼ç¢¼æœ€ä¸Šæ–¹çš„å…©è¡Œï¼š
    *   `var SHEET_ID = '...'`ï¼šè²¼ä¸Šå‰›å‰›çš„ **Sheet ID**ã€‚
    *   `var LINE_CHANNEL_ACCESS_TOKEN = '...'`ï¼šè²¼ä¸Šå‰›å‰›çš„ **LINE Token**ã€‚
5.  é»æ“Šå³ä¸Šè§’ **ã€Œéƒ¨ç½²ã€** > **ã€Œæ–°å¢éƒ¨ç½²ã€**ã€‚
    *   é¡å‹é¸ **ç¶²é æ‡‰ç”¨ç¨‹å¼ (Web App)**ã€‚
    *   åŸ·è¡Œèº«åˆ†ï¼š**æˆ‘ (Me)**ã€‚
    *   èª°å¯ä»¥å­˜å–ï¼š**ä»»ä½•äºº (Anyone)** <small>(â€»é€™é»å¾ˆé‡è¦)</small>ã€‚
6.  é»æ“Šéƒ¨ç½²ï¼ˆåˆæ¬¡éœ€æˆæ¬Šï¼‰ï¼Œå®Œæˆå¾Œè¤‡è£½ **ç¶²é æ‡‰ç”¨ç¨‹å¼ç¶²å€ (Web App URL)**ã€‚

### ç¬¬å››éšæ®µï¼šä¸²æ¥è¨­å®š
1.  **è¨­å®š LINE Webhook**ï¼š
    *   å›åˆ° LINE Developers Console > Messaging APIã€‚
    *   åœ¨ **Webhook settings** è²¼ä¸Šå‰›å‰›çš„ **Web App URL**ã€‚
    *   é»æ“Š Updateï¼Œé–‹å•Ÿ **Use webhook**ã€‚
    *   é»æ“Š Verify æ¸¬è©¦ï¼Œé¡¯ç¤º Success å³æˆåŠŸã€‚
2.  **è¨­å®šæ•™å­¸é€²åº¦ç¶²é **ï¼š
    *   æ‰“é–‹ `æ•™å­¸é€²åº¦ V8.6_å…¬é–‹ç‰ˆ.html`ã€‚
    *   é€²å…¥ **è¨­å®š** > **ç³»çµ±** > **é›²ç«¯åŒæ­¥è¨­å®š**ã€‚
    *   è²¼ä¸ŠåŒä¸€å€‹ **Web App URL**ã€‚

---
## ğŸ“± å¦‚ä½•ä½¿ç”¨ LINE Botï¼Ÿ
å°‡ä½ çš„æ©Ÿå™¨äººåŠ ç‚ºå¥½å‹ï¼Œå‚³é€ä»¥ä¸‹æ ¼å¼çš„è¨Šæ¯å³å¯è‡ªå‹•è¨˜éŒ„ï¼š

**æ ¼å¼**ï¼š`å­¸å¹´, ç­ç´š, ç§‘ç›®, é€²åº¦`
**ç¯„ä¾‹**ï¼š
> 114-1, 101ç­, åœ‹æ–‡, ç¬¬ä¸€èª²
> 114-1, 205ç­, æ•¸å­¸, 3-2ç¿’ä½œ, è¨˜å¾—å¸¶åœ“è¦

å›åˆ°ç¶²é ç‰ˆï¼Œé»æ“Š **ã€Œç«‹å³åŒæ­¥é›²ç«¯è³‡æ–™ã€**ï¼Œé€™äº›ç´€éŒ„å°±æœƒè‡ªå‹•å‡ºç¾ï¼

---
## é™„éŒ„ï¼šGoogle Apps Script ç¨‹å¼ç¢¼
*(è«‹è¤‡è£½ä»¥ä¸‹æ•´æ®µç¨‹å¼ç¢¼)*

```javascript
// --- è¨­å®šå€ ---
var SHEET_ID = 'è«‹è²¼ä¸Šæ‚¨çš„_SHEET_ID'; 
var LINE_CHANNEL_ACCESS_TOKEN = 'è«‹è²¼ä¸Šæ‚¨çš„_LINE_Token';

// --- ä»¥ä¸‹ç¨‹å¼ç¢¼ç„¡éœ€ä¿®æ”¹ ---
function doGet(e) {
  var sheet = SpreadsheetApp.openById(SHEET_ID).getSheets()[0];
  var data = sheet.getDataRange().getValues();
  var headers = data[0];
  var records = [];
  for (var i = 1; i < data.length; i++) {
    var record = {};
    for (var j = 0; j < headers.length; j++) {
      record[headers[j]] = data[i][j];
    }
    records.push(record);
  }
  return ContentService.createTextOutput(JSON.stringify(records)).setMimeType(ContentService.MimeType.JSON);
}

function doPost(e) {
  var sheet = SpreadsheetApp.openById(SHEET_ID).getSheets()[0];
  var postData = JSON.parse(e.postData.contents);
  
  if (postData.action === 'add_record') {
    appendRecord(sheet, postData.record);
    return ContentService.createTextOutput(JSON.stringify({status: 'success'})).setMimeType(ContentService.MimeType.JSON);
  }
  
  if (postData.events) {
    postData.events.forEach(function(event) {
      if (event.type === 'message' && event.message.type === 'text') {
        processLineMessage(sheet, event);
      }
    });
    return ContentService.createTextOutput(JSON.stringify({status: 'success'})).setMimeType(ContentService.MimeType.JSON);
  }
  return ContentService.createTextOutput(JSON.stringify({status: 'unknown'})).setMimeType(ContentService.MimeType.JSON);
}

function appendRecord(sheet, r) {
  if (sheet.getLastRow() === 0) sheet.appendRow(['id', 'timestamp', 'year', 'date', 'className', 'subject', 'progress', 'homework', 'quiz', 'note']);
  sheet.appendRow([r.id || Date.now(), r.timestamp || new Date().toISOString(), r.year, r.date, r.className, r.subject, r.progress, r.homework || '', r.quiz || false, r.note || '']);
}

function processLineMessage(sheet, event) {
  var text = event.message.text;
  var replyToken = event.replyToken;
  var parts = text.split(/,|ï¼Œ/).map(function(s){ return s.trim(); });
  
  if (parts.length < 4) {
    replyLine(replyToken, 'æ ¼å¼éŒ¯èª¤ã€‚è«‹è¼¸å…¥ï¼š\nå­¸å¹´, ç­ç´š, ç§‘ç›®, é€²åº¦\n(ä¾‹å¦‚: 114-1, 101ç­, åœ‹æ–‡, ç¬¬ä¸€èª²)');
    return;
  }
  
  var record = {
    id: Date.now(),
    timestamp: new Date().toISOString(),
    year: parts[0],
    className: parts[1],
    subject: parts[2],
    progress: parts[3],
    homework: parts[4] || '',
    quiz: false,
    note: 'From LINE',
    date: parts[5] || new Date().toISOString().split('T')[0]
  };
  
  appendRecord(sheet, record);
  replyLine(replyToken, 'âœ… å·²è¨˜éŒ„ï¼š' + record.className + ' ' + record.subject + ' (' + record.progress + ')');
}

function replyLine(replyToken, message) {
  UrlFetchApp.fetch('https://api.line.me/v2/bot/message/reply', {
    'headers': {
      'Content-Type': 'application/json; charset=UTF-8',
      'Authorization': 'Bearer ' + LINE_CHANNEL_ACCESS_TOKEN,
    },
    'method': 'post',
    'payload': JSON.stringify({
      'replyToken': replyToken,
      'messages': [{ 'type': 'text', 'text': message }]
    }),
  });
}
```
